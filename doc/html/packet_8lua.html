<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MoonGen: packet.lua File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MoonGen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="download.html"><span>Download</span></a></li>
      <li><a href="documentation.html"><span>Documentation</span></a></li>
      <li class="current"><a href="files.html"><span>Filebrowser</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('packet_8lua.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">packet.lua File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utility functions for packets (rte_mbuf).  
<a href="#details">More...</a></p>

<p><a href="packet_8lua_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5b0d50eb797ef2b260c50724fe3a3d84"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a5b0d50eb797ef2b260c50724fe3a3d84">getTimestamp</a> ()</td></tr>
<tr class="memdesc:a5b0d50eb797ef2b260c50724fe3a3d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the time stamp information.  <a href="#a5b0d50eb797ef2b260c50724fe3a3d84">More...</a><br/></td></tr>
<tr class="separator:a5b0d50eb797ef2b260c50724fe3a3d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10789b2c53556d4a523c5cd60680ee1"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#af10789b2c53556d4a523c5cd60680ee1">hasTimestamp</a> ()</td></tr>
<tr class="memdesc:af10789b2c53556d4a523c5cd60680ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the PKT_RX_IEEE1588_TMST flag is set.  <a href="#af10789b2c53556d4a523c5cd60680ee1">More...</a><br/></td></tr>
<tr class="separator:af10789b2c53556d4a523c5cd60680ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabc0aca59d6ad8cf2b808913bf9600a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aabc0aca59d6ad8cf2b808913bf9600a3"></a>
function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#aabc0aca59d6ad8cf2b808913bf9600a3">setVlan</a> (vlan, pcp, cfi)</td></tr>
<tr class="memdesc:aabc0aca59d6ad8cf2b808913bf9600a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Offload VLAN tagging to the NIC for this packet. <br/></td></tr>
<tr class="separator:aabc0aca59d6ad8cf2b808913bf9600a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83814f965e47dd43d1636308a1b2df92"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83814f965e47dd43d1636308a1b2df92"></a>
function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a83814f965e47dd43d1636308a1b2df92">getVlan</a> ()</td></tr>
<tr class="memdesc:a83814f965e47dd43d1636308a1b2df92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the VLAN associated with a received packet. <br/></td></tr>
<tr class="separator:a83814f965e47dd43d1636308a1b2df92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b57d15d38741b7878ad8d06b88ebbb2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b57d15d38741b7878ad8d06b88ebbb2"></a>
function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a6b57d15d38741b7878ad8d06b88ebbb2">setDelay</a> (delay)</td></tr>
<tr class="memdesc:a6b57d15d38741b7878ad8d06b88ebbb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the time to wait before the packet is sent for software rate-controlled send methods. <br/></td></tr>
<tr class="separator:a6b57d15d38741b7878ad8d06b88ebbb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e10ab9efc9f793fb8125de25bc1605"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a04e10ab9efc9f793fb8125de25bc1605">setRate</a> (rate)</td></tr>
<tr class="separator:a04e10ab9efc9f793fb8125de25bc1605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ce788acb683d3a0690599805e480dc"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a51ce788acb683d3a0690599805e480dc">setSize</a> (size)</td></tr>
<tr class="separator:a51ce788acb683d3a0690599805e480dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf539eaa6742ff5dc815282767ca303e"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#abf539eaa6742ff5dc815282767ca303e">get</a> ()</td></tr>
<tr class="memdesc:abf539eaa6742ff5dc815282767ca303e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the packet data cast to the best fitting packet struct.  <a href="#abf539eaa6742ff5dc815282767ca303e">More...</a><br/></td></tr>
<tr class="separator:abf539eaa6742ff5dc815282767ca303e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2635156d751e509e4b4f607a2b045c5a"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a2635156d751e509e4b4f607a2b045c5a">dump</a> (bytes)</td></tr>
<tr class="memdesc:a2635156d751e509e4b4f607a2b045c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dumps the packet data cast to the best fitting packet struct.  <a href="#a2635156d751e509e4b4f607a2b045c5a">More...</a><br/></td></tr>
<tr class="separator:a2635156d751e509e4b4f607a2b045c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0685d073d3e09a706083bbabe2328d0d"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a0685d073d3e09a706083bbabe2328d0d">offloadIPSec</a> (idx, sec_type, esp_mode)</td></tr>
<tr class="memdesc:a0685d073d3e09a706083bbabe2328d0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use IPsec offloading.  <a href="#a0685d073d3e09a706083bbabe2328d0d">More...</a><br/></td></tr>
<tr class="separator:a0685d073d3e09a706083bbabe2328d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98683c8c5fa79fb9964f84125b437b65"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a98683c8c5fa79fb9964f84125b437b65">setESPTrailerLength</a> (len)</td></tr>
<tr class="memdesc:a98683c8c5fa79fb9964f84125b437b65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the ESP trailer length.  <a href="#a98683c8c5fa79fb9964f84125b437b65">More...</a><br/></td></tr>
<tr class="separator:a98683c8c5fa79fb9964f84125b437b65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07b89b4064afceae93179acfa2c91d78"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a07b89b4064afceae93179acfa2c91d78">offloadIPChecksum</a> (ipv4, l2_len, l3_len)</td></tr>
<tr class="memdesc:a07b89b4064afceae93179acfa2c91d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instruct the NIC to calculate the IP checksum for this packet.  <a href="#a07b89b4064afceae93179acfa2c91d78">More...</a><br/></td></tr>
<tr class="separator:a07b89b4064afceae93179acfa2c91d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00540dd9e039f047b33ee4bf066a0bc"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#ab00540dd9e039f047b33ee4bf066a0bc">offloadUdpChecksum</a> (ipv4, l2_len, l3_len)</td></tr>
<tr class="memdesc:ab00540dd9e039f047b33ee4bf066a0bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instruct the NIC to calculate the IP and UDP checksum for this packet.  <a href="#ab00540dd9e039f047b33ee4bf066a0bc">More...</a><br/></td></tr>
<tr class="separator:ab00540dd9e039f047b33ee4bf066a0bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bcf3c64f8c48891a26a5541de496f65"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a2bcf3c64f8c48891a26a5541de496f65">offloadTcpChecksum</a> (ipv4, l2_len, l3_len)</td></tr>
<tr class="memdesc:a2bcf3c64f8c48891a26a5541de496f65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Instruct the NIC to calculate the IP and TCP checksum for this packet.  <a href="#a2bcf3c64f8c48891a26a5541de496f65">More...</a><br/></td></tr>
<tr class="separator:a2bcf3c64f8c48891a26a5541de496f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0443a417cdc375adfd2b90ff442596a"><td class="memItemLeft" align="right" valign="top">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#ac0443a417cdc375adfd2b90ff442596a">enableTimestamps</a> ()</td></tr>
<tr class="separator:ac0443a417cdc375adfd2b90ff442596a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec741ec046b38ff23624e841a2ec3da"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a9ec741ec046b38ff23624e841a2ec3da">packetCreate</a> (...)</td></tr>
<tr class="memdesc:a9ec741ec046b38ff23624e841a2ec3da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create struct and functions for a new packet.  <a href="#a9ec741ec046b38ff23624e841a2ec3da">More...</a><br/></td></tr>
<tr class="separator:a9ec741ec046b38ff23624e841a2ec3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af642220d56015aa315416d6202dcef"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a0af642220d56015aa315416d6202dcef">getHeaderMember</a> (v)</td></tr>
<tr class="memdesc:a0af642220d56015aa315416d6202dcef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of the header and the name of the respective member of a packet.  <a href="#a0af642220d56015aa315416d6202dcef">More...</a><br/></td></tr>
<tr class="separator:a0af642220d56015aa315416d6202dcef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3637a202dd87b6f65ed3a0f2e580360"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#ac3637a202dd87b6f65ed3a0f2e580360">packetGetHeaders</a> (self)</td></tr>
<tr class="memdesc:ac3637a202dd87b6f65ed3a0f2e580360"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all headers of a packet as list.  <a href="#ac3637a202dd87b6f65ed3a0f2e580360">More...</a><br/></td></tr>
<tr class="separator:ac3637a202dd87b6f65ed3a0f2e580360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7205e5d1a92c37d7fd9b68555bcdaa1"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#ac7205e5d1a92c37d7fd9b68555bcdaa1">packetGetHeader</a> (self, h)</td></tr>
<tr class="memdesc:ac7205e5d1a92c37d7fd9b68555bcdaa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the specified header of a packet (e.g.  <a href="#ac7205e5d1a92c37d7fd9b68555bcdaa1">More...</a><br/></td></tr>
<tr class="separator:ac7205e5d1a92c37d7fd9b68555bcdaa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b16486a2c3acbb96327174375464b14"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a7b16486a2c3acbb96327174375464b14">packetDump</a> (self, bytes)</td></tr>
<tr class="memdesc:a7b16486a2c3acbb96327174375464b14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a hex dump of a packet.  <a href="#a7b16486a2c3acbb96327174375464b14">More...</a><br/></td></tr>
<tr class="separator:a7b16486a2c3acbb96327174375464b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc45c322a397d3e476801103a4f0ecb8"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#adc45c322a397d3e476801103a4f0ecb8">packetFill</a> (self, namedArgs)</td></tr>
<tr class="memdesc:adc45c322a397d3e476801103a4f0ecb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all members of all headers.  <a href="#adc45c322a397d3e476801103a4f0ecb8">More...</a><br/></td></tr>
<tr class="separator:adc45c322a397d3e476801103a4f0ecb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9184100d6f5e1a29c8e6b580c40c6a3a"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a9184100d6f5e1a29c8e6b580c40c6a3a">packetGet</a> (self)</td></tr>
<tr class="memdesc:a9184100d6f5e1a29c8e6b580c40c6a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the values of all members as list of named arguments.  <a href="#a9184100d6f5e1a29c8e6b580c40c6a3a">More...</a><br/></td></tr>
<tr class="separator:a9184100d6f5e1a29c8e6b580c40c6a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6e8135b9fcdfa8b19c81b2e462c1d2"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#acf6e8135b9fcdfa8b19c81b2e462c1d2">packetResolveLastHeader</a> (self)</td></tr>
<tr class="memdesc:acf6e8135b9fcdfa8b19c81b2e462c1d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to find out what the next header in the payload of this packet is.  <a href="#acf6e8135b9fcdfa8b19c81b2e462c1d2">More...</a><br/></td></tr>
<tr class="separator:acf6e8135b9fcdfa8b19c81b2e462c1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30b6738c865511bbfed8543ab1a1e8da"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a30b6738c865511bbfed8543ab1a1e8da">packetSetLength</a> (args)</td></tr>
<tr class="memdesc:a30b6738c865511bbfed8543ab1a1e8da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set length for all headers.  <a href="#a30b6738c865511bbfed8543ab1a1e8da">More...</a><br/></td></tr>
<tr class="separator:a30b6738c865511bbfed8543ab1a1e8da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8943f1f6dcf9b679353e419b66bd5691"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a8943f1f6dcf9b679353e419b66bd5691">packetCalculateChecksums</a> (args)</td></tr>
<tr class="memdesc:a8943f1f6dcf9b679353e419b66bd5691"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate all checksums manually (not offloading them).  <a href="#a8943f1f6dcf9b679353e419b66bd5691">More...</a><br/></td></tr>
<tr class="separator:a8943f1f6dcf9b679353e419b66bd5691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1d90118b8f6ce7174b5f65ffc18b64"><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#a8e1d90118b8f6ce7174b5f65ffc18b64">packetMakeStruct</a> (...)</td></tr>
<tr class="memdesc:a8e1d90118b8f6ce7174b5f65ffc18b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a packet struct (cdata) consisting of different headers.  <a href="#a8e1d90118b8f6ce7174b5f65ffc18b64">More...</a><br/></td></tr>
<tr class="separator:a8e1d90118b8f6ce7174b5f65ffc18b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af8027fe3e9f1acfedd960d3c9b8b6b51"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af8027fe3e9f1acfedd960d3c9b8b6b51"></a>
local&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> = {}</td></tr>
<tr class="memdesc:af8027fe3e9f1acfedd960d3c9b8b6b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Module for packets (rte_mbuf) <br/></td></tr>
<tr class="separator:af8027fe3e9f1acfedd960d3c9b8b6b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2f407eb52749e5ff3e1b78c6a4cef4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acf2f407eb52749e5ff3e1b78c6a4cef4"></a>
<a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="packet_8lua.html#acf2f407eb52749e5ff3e1b78c6a4cef4">packetStructs</a> = {}</td></tr>
<tr class="memdesc:acf2f407eb52749e5ff3e1b78c6a4cef4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Table that contains the names and args of all created packet structs. <br/></td></tr>
<tr class="separator:acf2f407eb52749e5ff3e1b78c6a4cef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utility functions for packets (rte_mbuf). </p>
<p>Includes:</p>
<ul>
<li>General functions (timestamping, rate control, ...)</li>
<li>Offloading</li>
<li>Create packet types </li>
</ul>

<p>Definition in file <a class="el" href="packet_8lua_source.html">packet.lua</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2635156d751e509e4b4f607a2b045c5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> dump </td>
          <td>(</td>
          <td class="paramtype">bytes&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dumps the packet data cast to the best fitting packet struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bytes</td><td>number of bytes to dump, optional </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="l3-tcp-syn-flood_8lua-example.html#a19">l3-tcp-syn-flood.lua</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ac0443a417cdc375adfd2b90ff442596a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> enableTimestamps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd>TODO docu </dd></dl>

</div>
</div>
<a class="anchor" id="abf539eaa6742ff5dc815282767ca303e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> get </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the packet data cast to the best fitting packet struct. </p>
<p>Starting with ethernet header. </p>
<dl class="section return"><dt>Returns</dt><dd>packet data as cdata of best fitting packet </dd></dl>

</div>
</div>
<a class="anchor" id="a0af642220d56015aa315416d6202dcef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function getHeaderMember </td>
          <td>(</td>
          <td class="paramtype">v&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of the header and the name of the respective member of a packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Either the name of the header (then the member has the same name), or a table { header, member } </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the header </dd>
<dd>
Name of the member </dd></dl>

</div>
</div>
<a class="anchor" id="a5b0d50eb797ef2b260c50724fe3a3d84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> getTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the time stamp information. </p>
<dl class="section return"><dt>Returns</dt><dd>The timestamp or nil if the packet was not time stamped. </dd></dl>

</div>
</div>
<a class="anchor" id="af10789b2c53556d4a523c5cd60680ee1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> hasTimestamp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the PKT_RX_IEEE1588_TMST flag is set. </p>
<p>Turns out that this flag is pretty pointless, it does not indicate if the packet was actually timestamped, just that it came from a queue/filter with timestamping enabled. You probably want to use device:<a class="el" href="packet_8lua.html#af10789b2c53556d4a523c5cd60680ee1" title="Check if the PKT_RX_IEEE1588_TMST flag is set. ">hasTimestamp()</a> and check the sequence number. </p>

</div>
</div>
<a class="anchor" id="a07b89b4064afceae93179acfa2c91d78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> offloadIPChecksum </td>
          <td>(</td>
          <td class="paramtype">ipv4&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l2_len&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l3_len&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Instruct the NIC to calculate the IP checksum for this packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ipv4</td><td>Boolean to decide whether the packet uses IPv4 (set to nil/true) or IPv6 (set to anything else). In case it is an IPv6 packet, do nothing (the header has no checksum). </td></tr>
    <tr><td class="paramname">l2_len</td><td>Length of the layer 2 header in bytes (default 14 bytes for ethernet). </td></tr>
    <tr><td class="paramname">l3_len</td><td>Length of the layer 3 header in bytes (default 20 bytes for IPv4). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0685d073d3e09a706083bbabe2328d0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> offloadIPSec </td>
          <td>(</td>
          <td class="paramtype">idx&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sec_type&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">esp_mode&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use IPsec offloading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>SA_IDX to use </td></tr>
    <tr><td class="paramname">sec_type</td><td>IPSec type to use ("esp"/"ah") </td></tr>
    <tr><td class="paramname">esp_mode</td><td>ESP mode to use encrypt(1) or authenticate(0) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a2bcf3c64f8c48891a26a5541de496f65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> offloadTcpChecksum </td>
          <td>(</td>
          <td class="paramtype">ipv4&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l2_len&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l3_len&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Instruct the NIC to calculate the IP and TCP checksum for this packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ipv4</td><td>Boolean to decide whether the packet uses IPv4 (set to nil/true) or IPv6 (set to anything else). </td></tr>
    <tr><td class="paramname">l2_len</td><td>Length of the layer 2 header in bytes (default 14 bytes for ethernet). </td></tr>
    <tr><td class="paramname">l3_len</td><td>Length of the layer 3 header in bytes (default 20 bytes for IPv4, 40 bytes for IPv6). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab00540dd9e039f047b33ee4bf066a0bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> offloadUdpChecksum </td>
          <td>(</td>
          <td class="paramtype">ipv4&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l2_len&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">l3_len&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Instruct the NIC to calculate the IP and UDP checksum for this packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ipv4</td><td>Boolean to decide whether the packet uses IPv4 (set to nil/true) or IPv6 (set to anything else). </td></tr>
    <tr><td class="paramname">l2_len</td><td>Length of the layer 2 header in bytes (default 14 bytes for ethernet). </td></tr>
    <tr><td class="paramname">l3_len</td><td>Length of the layer 3 header in bytes (default 20 bytes for IPv4, 40 bytes for IPv6). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8943f1f6dcf9b679353e419b66bd5691"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetCalculateChecksums </td>
          <td>(</td>
          <td class="paramtype">args&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate all checksums manually (not offloading them). </p>
<p>There also exist functions to calculate the checksum of only one header. Naming convention: pkt:calculate&lt;member&gt;Checksum() (for all existing packets member = {Ip, Tcp, Udp, Icmp}) </p>
<dl class="section note"><dt>Note</dt><dd>Calculating checksums manually is extremely slow compared to offloading this task to the NIC (~65% performance loss at the moment) </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>Manual calculation of udp and tcp checksums NYI </dd></dl>

</div>
</div>
<a class="anchor" id="a9ec741ec046b38ff23624e841a2ec3da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetCreate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create struct and functions for a new packet. </p>
<p>For implemented headers (see proto/) these packets are defined in the section 'Packet struct' of each protocol file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>list of keywords (see makeStruct) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>returns the constructor/cast function for this packet </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="packet_8lua.html#a8e1d90118b8f6ce7174b5f65ffc18b64" title="Creates a packet struct (cdata) consisting of different headers. ">packetMakeStruct</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a7b16486a2c3acbb96327174375464b14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetDump </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bytes&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a hex dump of a packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>the packet </td></tr>
    <tr><td class="paramname">bytes</td><td>Number of bytes to dump. If no size is specified the payload is truncated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adc45c322a397d3e476801103a4f0ecb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetFill </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">namedArgs&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set all members of all headers. </p>
<p>Per default, all members are set to default values specified in the respective set function. Optional named arguments can be used to set a member to a user-provided value. The argument 'pktLength' can be used to automatically calculate and set the length member of headers (e.g. ip header). </p>
<div class="fragment"><div class="line"><a class="code" href="ah_8lua.html#ad1accb1a9bd14f199547cd1c93b108ad">fill</a>() --- only <span class="keywordflow">default</span> values</div>
<div class="line"><a class="code" href="ah_8lua.html#ad1accb1a9bd14f199547cd1c93b108ad">fill</a>{ ethSrc=<span class="stringliteral">&quot;12:23:34:45:56:67&quot;</span>, ipTTL=100 } --- all members are <a class="code" href="ah_8lua.html#a33f224ab9bc8a4fabf72fd9bc264e7a0">set</a> to <span class="keywordflow">default</span> values with the exception of ethSrc and ipTTL</div>
<div class="line"><a class="code" href="ah_8lua.html#ad1accb1a9bd14f199547cd1c93b108ad">fill</a>{ pktLength=64 } --- only <span class="keywordflow">default</span> values, length members of the headers are adjusted</div>
</div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The packet </td></tr>
    <tr><td class="paramname">args</td><td>Table of named arguments. For a list of available arguments see "See also" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is slow. If you want to modify members of a header during a time critical section of your script use the respective setters. </dd></dl>

</div>
</div>
<a class="anchor" id="a9184100d6f5e1a29c8e6b580c40c6a3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetGet </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the values of all members as list of named arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Table of named arguments. For a list of arguments see "See also". </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="packet_8lua.html#adc45c322a397d3e476801103a4f0ecb8" title="Set all members of all headers. ">packetFill</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ac7205e5d1a92c37d7fd9b68555bcdaa1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetGetHeader </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">h&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the specified header of a packet (e.g. </p>
<p>self.eth). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>the packet (cdata) </td></tr>
    <tr><td class="paramname">h</td><td>header to be returned </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The member of the packet </dd></dl>

</div>
</div>
<a class="anchor" id="ac3637a202dd87b6f65ed3a0f2e580360"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetGetHeaders </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get all headers of a packet as list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Table of members of the packet </dd></dl>

</div>
</div>
<a class="anchor" id="a8e1d90118b8f6ce7174b5f65ffc18b64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetMakeStruct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a packet struct (cdata) consisting of different headers. </p>
<p>Simply list the headers in the order you want them to be in a packet. If you want the member to be named differently, use the following syntax: normal: &lt;header&gt; ; different membername: { &lt;header&gt;, &lt;member&gt; }. Supported keywords: eth, arp, ptp, ip, ip6, udp, tcp, icmp </p>
<div class="fragment"><div class="line">makeStruct(<span class="stringliteral">&#39;eth&#39;</span>, { <span class="stringliteral">&#39;ip4&#39;</span>, <span class="stringliteral">&#39;ip&#39;</span> }, <span class="stringliteral">&#39;udp&#39;</span>) --- creates an UDP packet <span class="keyword">struct</span></div>
<div class="line">--- the ip4 member of the packet is named <span class="stringliteral">&#39;ip&#39;</span></div>
</div><!-- fragment --><p> The name of the created (internal) struct looks as follows: struct <b>HEADER1_MEMBER1__HEADER2_MEMBER2 ... Only the "&lt;/strong&gt;" (double underscore) has the special meaning of "a new header starts with name 
 everything until "_" (single underscore)&gt;, followed by the member name &lt;everything after "_" 
until next header starts (indicated by next __)&gt;" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>list of keywords/tables of keyword-member pairs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>name name of the struct </dd>
<dd>
ctype ctype of the struct </dd></dl>
<p></b></p>

</div>
</div>
<a class="anchor" id="acf6e8135b9fcdfa8b19c81b2e462c1d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetResolveLastHeader </td>
          <td>(</td>
          <td class="paramtype">self&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to find out what the next header in the payload of this packet is. </p>
<p>This function is only used for buf:get/buf:dump </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The packet </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a30b6738c865511bbfed8543ab1a1e8da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function packetSetLength </td>
          <td>(</td>
          <td class="paramtype">args&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set length for all headers. </p>
<p>Necessary when sending variable sized packets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">self</td><td>The packet </td></tr>
    <tr><td class="paramname">length</td><td>Length of the packet. Value for respective length member of headers get calculated using this value. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a98683c8c5fa79fb9964f84125b437b65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> setESPTrailerLength </td>
          <td>(</td>
          <td class="paramtype">len&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the ESP trailer length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>ESP Trailer length in bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a04e10ab9efc9f793fb8125de25bc1605"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> setRate </td>
          <td>(</td>
          <td class="paramtype">rate&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>TODO docu </dd></dl>

</div>
</div>
<a class="anchor" id="a51ce788acb683d3a0690599805e480dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="packet_8lua.html#af8027fe3e9f1acfedd960d3c9b8b6b51">pkt</a> setSize </td>
          <td>(</td>
          <td class="paramtype">size&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000021">Todo:</a></b></dt><dd>TODO does </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="packet_8lua.html">packet.lua</a></li>
    <li class="footer">Generated on Thu Aug 27 2015 17:51:42 for MoonGen by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
